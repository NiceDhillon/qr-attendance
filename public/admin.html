<!DOCTYPE html>
<html>
<head>
  <title>Admin - Generate QR</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
  <h2>Generate QR</h2>
  <button onclick="generate()">Generate QR</button>

  <div class="info" id="status"></div>
  <img id="qr">
</div>

<script>
function generate() {
  document.getElementById("status").innerText = "Fetching location...";

  navigator.geolocation.getCurrentPosition(pos => {
    fetch("/generate-qr", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        lat: pos.coords.latitude,
        lon: pos.coords.longitude,
        accuracy: pos.coords.accuracy
      })
    })
    .then(r => r.json())
    .then(d => {
      document.getElementById("qr").src = d.qr;
      document.getElementById("status").innerText =
        `Generated: ${d.generatedAt}\nExpires: ${d.expiresAt}`;
    });
  });
}
</script>

</body>
</html>
